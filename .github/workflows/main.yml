name: Sync commits to Notion
on: [push]

jobs:
  notion_hook_job:
    runs-on: ubuntu-latest
    env:
      NOTION_VERSION: "2022-06-28"     # lets the action send toggle blocks
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0               # keep history

      - name: Send commit info to Notion
        uses: alessandrobelli/NotionHook@1.1
        with:
          notion_secret:   ${{ secrets.NOTION_SECRET }}
          notion_database: ${{ secrets.NOTION_DATABASE }}

          # map GitHub fields → your column names
          commit_description: "Description"   # or "Title"
          commit_url:        "Url"
          commit_id:         "Id"             # or "Commit SHA"
          commit_project:    "Project"

          # --- turn OFF file listing ---
          files_format: ""        # empty string → skip diff → token not needed
          token:        ${{ github.token }}
