name: Sync commits to Notion
on:
  push:

jobs:
  notion_hook_job:
    runs-on: ubuntu-latest
    steps:
      # 1) Check out full history so we can diff commits
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      # 2) Send each commit to Notion (no file list)
      - name: Send commit info to Notion
        uses: bestisblessed/NotionHook@main   # ← replace with your fork
        with:
          notion_secret:   ${{ secrets.NOTION_SECRET }}
          notion_database: ${{ secrets.NOTION_DATABASE }}

          # map your GitHub fields → Notion columns
          commit_description: "Description"   # rich-text column name
          commit_url:        "Url"            # URL column name
          commit_id:         "Id"             # plain-text column name
          commit_project:    "Project"        # multi-select column name

          # turn off the file‐list block entirely
          files_format:      "none"

          # GitHub token to fetch diffs (unused when `files_format: none`)
          token:             ${{ secrets.GITHUB_TOKEN }}
